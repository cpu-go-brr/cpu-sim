name: Intel4004
description: The Intel 4004 is a 4-bit central processing unit (CPU) released by Intel Corporation in 1971

memory:
  internal:
    PC: 8
    OUT:
      VAL: 8
      SEND: 1
  external:
    rom:
      words: 255
      bits: 4
    band:
      words: 255
      bits: 8

fetch:
  instructions:
    - 0 --> SEND
    - rom(PC)

instructions:
  nop:
    code: 0000
    asm: 0000
    description: No Operation
    instructions:
  "right":
    code: 0001
    asm: 0001
    description: Increment the data pointer (to point to the next cell to the right). 
    instructions:
      - PC + 1 --> PC
  "left":
    code: 0010
    asm: 0010
    description: Decrement the data pointer (to point to the next cell to the left). 
    instructions:
      - PC + 254 --> PC
  "inc":
    code: 0011
    asm: 0011
    description: Increment (increase by one) the byte at the data pointer. 
    instructions:
      - band(PC) + 1 --> band(PC)
  "dec":
    code: 0100
    asm: 0100
    description: Decrement (decrease by one) the byte at the data pointer. 
    instructions:
      - band(PC) + 244 --> band(PC)
  "prt":
    code: 0101
    asm: 0101
    description: Output the byte at the data pointer. 
    instructions:
      - band(PC) --> VAL
      - 1 --> SEND
  "red":
    code: 0110
    asm: 0110
    description: Accept one byte of input, storing its value in the byte at the data pointer. 
    instructions:
      - VAL --> band(PC)
      - 1 --> SEND
  "lp":
    code: 0111
    asm: 0111
    description: If the byte at the data pointer is zero, then instead of moving the instruction pointer 
      forward to the next command, jump it forward to the command after the matching ] command. 
    instructions:
      - band(PC) == 0 ? (rom(PC +1), rom(PC+2))--> PC
      - band(PC) != 0 ? PC+3--> PC
  "rt":
    code: 1000
    asm: 1000
    description: If the byte at the data pointer is zero, then instead of moving the instruction pointer 
      forward to the next command, jump it forward to the command after the matching ] command. 
    instructions:
      - band(PC) != 0 ? (rom(PC +1), rom(PC+2))--> PC
      - band(PC) == 0 ? PC+3--> PC

display: 
  "PC 0x{PC}\n"